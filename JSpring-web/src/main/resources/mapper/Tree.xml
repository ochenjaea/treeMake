<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tree">

	<select id="getTree" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			SEQ
			,SEQ
			,GROUP_NAME
			,PARENT_SEQ
		FROM 
			TB_GROUP
		WHERE PARENT_SEQ = #{parent_id};
	</select>
	
	<select id="checkChildNodeCnt" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			COUNT(SEQ) AS CNT
		FROM 
			TB_GROUP
		WHERE PARENT_SEQ = #{seq};
	</select>
	
	<select id="checkChildNode" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			SEQ
		FROM 
			TB_GROUP
		WHERE PARENT_SEQ = #{seq};
	</select>
	
	<insert id="insertTreeNode" parameterType="java.util.HashMap">
		INSERT INTO TB_GROUP(
			GROUP_NAME
			,PARENT_SEQ
		) VALUES(
			'new Node'
			,#{parent_id}
		)
	</insert>
	
	<delete id="removeTreeNode">
		DELETE FROM TB_GROUP
			WHERE
		SEQ IN
		<foreach item="item" index="index" collection="list"
			open="(" separator="," close=")">
			#{item}
		</foreach>
	</delete>
	
	<update id="updateTreeNodeText" parameterType="java.util.HashMap">
		UPDATE TB_GROUP SET
			GROUP_NAME = #{new_text}
		WHERE
			SEQ = #{seq}
			AND PARENT_SEQ = #{parent_id}
			AND GROUP_NAME = #{old_text}
	</update>
<!-- 
	<insert id="joinInsert">
	INSERT INTO auth_member(
		user_id,
		passwd,
		user_nm,
		email,
		receive,
		use_yn,
		reg_date
	)VALUES(
		#{userId},
		#{passwd},
		#{userNm},
		#{email},
		#{receive},
		'Y',
		/*SYSDATE()*/
		datetime('now','localtime')
	)
	</insert>
 -->
</mapper> 